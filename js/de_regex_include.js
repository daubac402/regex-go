!function(){navigator.mozId?navigator.id=navigator.mozId:!function(){function o(b){if(n===a)n=b;else if(n!=b)throw new Error("you cannot combine the navigator.id.watch() API with navigator.id.getVerifiedEmail() or navigator.id.get()this site should instead use navigator.id.request() and navigator.id.watch()")}function s(a){document.addEventListener?document.addEventListener("DOMContentLoaded",function b(){document.removeEventListener("DOMContentLoaded",b),a()},!1):document.attachEvent&&document.readyState&&document.attachEvent("onreadystatechange",function b(){var c=document.readyState;"loaded"!==c&&"complete"!==c&&"interactive"!==c||(document.detachEvent("onreadystatechange",b),a())})}function t(){if(r){var c=window.document;if(!c.body)return void(q||(s(t),q=!0));try{if(!p){var e=c.createElement("iframe");e.style.display="none",c.body.appendChild(e),e.src=d+"/communication_iframe",p=b.build({window:e.contentWindow,origin:d,scope:"mozid_ni",onReady:function(){p.call({method:"loaded",success:function(){l.ready&&l.ready()},error:function(){}})}}),p.bind("logout",function(a,b){l.logout&&l.logout()}),p.bind("login",function(a,b){l.login&&l.login(b)}),p.bind("match",function(a,b){l.match&&l.match()}),u(m)&&p.notify({method:"loggedInUser",params:m})}}catch(b){p=a}}}function u(a){return"undefined"!=typeof a}function v(a){try{console.warn(a)}catch(a){}}function w(a,b){if(u(a[b]))return v(b+" has been deprecated"),!0}function x(a,b,c){if(u(a[b])&&u(a[c]))throw new Error("you cannot supply *both* "+b+" and "+c);w(a,b)&&(a[c]=a[b],delete a[b])}function y(a){if("object"==typeof a){if(a.onlogin&&"function"!=typeof a.onlogin||a.onlogout&&"function"!=typeof a.onlogout||a.onmatch&&"function"!=typeof a.onmatch||a.onready&&"function"!=typeof a.onready)throw new Error("non-function where function expected in parameters to navigator.id.watch()");if(!a.onlogin)throw new Error("'onlogin' is a required argument to navigator.id.watch()");if(!a.onlogout&&(a.onmatch||"loggedInUser"in a))throw new Error("stateless api only allows onlogin and onready options");if(l.login=a.onlogin||null,l.logout=a.onlogout||null,l.match=a.onmatch||null,l.ready=a.onready||null,x(a,"loggedInEmail","loggedInUser"),m=a.loggedInUser,m===!1&&(m=null),!z(m)&&!A(m)&&!B(m))throw new Error("loggedInUser is not a valid type");t()}}function z(a){return null===a}function A(a){return"undefined"==typeof a}function B(a){return"[object String]"===Object.prototype.toString.apply(a)}function D(){var a=C;return"request"===a&&(a=l.logout?l.ready?"watch_with_onready":"watch_without_onready":"stateless"),a}function E(b){function f(){return c.isSupported()&&e}function m(){var a=c.getNoSupportReason();if(!a&&!e)return i}function q(){if(p)return p.call({method:"redirect_flow",params:JSON.stringify(b),success:function(){window.location=d+"/sign_in"}})}w(b,"requiredEmail"),x(b,"tosURL","termsOfService"),x(b,"privacyURL","privacyPolicy"),b.termsOfService&&!b.privacyPolicy&&v("termsOfService ignored unless privacyPolicy also defined"),b.privacyPolicy&&!b.termsOfService&&v("privacyPolicy ignored unless termsOfService also defined"),b.rp_api=D();var e=!h||"request"===C||"auth"===C;if(C=null,b.start_time=(new Date).getTime(),!k){if(!f()){var n=m(),o="unsupported_dialog";return"LOCALSTORAGE_DISABLED"===n?o="cookies_disabled":n===i&&(o="unsupported_dialog_without_watch"),void(k=window.open(d+"/"+o,j,g))}return p&&p.notify({method:"dialog_running"}),h?q():void(k=WinChan.open({url:d+"/sign_in",relay_url:d+"/relay",window_features:g,window_name:j,params:{method:"get",params:b}},function(c,d){if(p){!c&&d&&d.email&&p.notify({method:"loggedInUser",params:d.email});var e=!(c||d&&d.assertion);p.notify({method:"dialog_complete",params:e})}if(k=a,!c&&d&&d.assertion)try{l.login&&l.login(d.assertion)}catch(a){throw console.log(a),a}"client closed window"!==c&&d||(b&&b.oncancel&&b.oncancel(),delete b.oncancel)}))}try{k.focus()}catch(a){}}var a,b=function(){"use strict";function d(a,b,d,e){function f(b){for(var c=0;c<b.length;c++)if(b[c].win===a)return!0;return!1}var g=!1;if("*"===b){for(var h in c)if(c.hasOwnProperty(h)&&"*"!==h&&"object"==typeof c[h][d]&&(g=f(c[h][d])))break}else c["*"]&&c["*"][d]&&(g=f(c["*"][d])),!g&&c[b]&&c[b][d]&&(g=f(c[b][d]));if(g)throw"A channel is already bound to the same window which overlaps with origin '"+b+"' and has scope '"+d+"'";"object"!=typeof c[b]&&(c[b]={}),"object"!=typeof c[b][d]&&(c[b][d]=[]),c[b][d].push({win:a,handler:e})}function e(a,b,d){for(var e=c[b][d],f=0;f<e.length;f++)e[f].win===a&&e.splice(f,1);0===c[b][d].length&&delete c[b][d]}function f(a){return Array.isArray?Array.isArray(a):a.constructor.toString().indexOf("Array")!=-1}var b=Math.floor(1000001*Math.random()),c={},g={},h=function(a){try{var b=JSON.parse(a.data);if("object"!=typeof b||null===b)throw"malformed"}catch(a){return}var f,h,i,d=a.source,e=a.origin;if("string"==typeof b.method){var j=b.method.split("::");2==j.length?(f=j[0],i=j[1]):i=b.method}if("undefined"!=typeof b.id&&(h=b.id),"string"==typeof i){var k=!1;if(c[e]&&c[e][f])for(var l=0;l<c[e][f].length;l++)if(c[e][f][l].win===d){c[e][f][l].handler(e,i,b),k=!0;break}if(!k&&c["*"]&&c["*"][f])for(var l=0;l<c["*"][f].length;l++)if(c["*"][f][l].win===d){c["*"][f][l].handler(e,i,b);break}}else"undefined"!=typeof h&&g[h]&&g[h](e,i,b)};return window.addEventListener?window.addEventListener("message",h,!1):window.attachEvent&&window.attachEvent("onmessage",h),{build:function(c){var h=function(a){if(c.debugOutput&&window.console&&window.console.log){try{"string"!=typeof a&&(a=JSON.stringify(a))}catch(a){}console.log("["+k+"] "+a)}};if(!window.postMessage)throw"jschannel cannot run this browser, no postMessage";if(!window.JSON||!window.JSON.stringify||!window.JSON.parse)throw"jschannel cannot run this browser, no JSON parsing/serialization";if("object"!=typeof c)throw"Channel build invoked without a proper object argument";if(!c.window||!c.window.postMessage)throw"Channel.build() called without a valid window argument";if(window===c.window)throw"target window is same as present window -- not allowed";var i=!1;if("string"==typeof c.origin){var j;"*"===c.origin?i=!0:null!==(j=c.origin.match(/^https?:\/\/(?:[-a-zA-Z0-9_\.])+(?::\d+)?/))&&(c.origin=j[0].toLowerCase(),i=!0)}if(!i)throw"Channel.build() called with an invalid origin";if("undefined"!=typeof c.scope){if("string"!=typeof c.scope)throw"scope, when specified, must be a string";if(c.scope.split("::").length>1)throw"scope may not contain double colons: '::'"}var k=function(){for(var a="",b="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789",c=0;c<5;c++)a+=b.charAt(Math.floor(Math.random()*b.length));return a}(),l={},m={},n={},o=!1,p=[],q=function(a,b,c){var d=!1,e=!1;return{origin:b,invoke:function(b,d){if(!n[a])throw"attempting to invoke a callback of a nonexistent transaction: "+a;for(var e=!1,f=0;f<c.length;f++)if(b===c[f]){e=!0;break}if(!e)throw"request supports no such callback '"+b+"'";u({id:a,callback:b,params:d})},error:function(b,c){if(e=!0,!n[a])throw"error called for nonexistent message: "+a;delete n[a],u({id:a,error:b,message:c})},complete:function(b){if(e=!0,!n[a])throw"complete called for nonexistent message: "+a;delete n[a],u({id:a,result:b})},delayReturn:function(a){return"boolean"==typeof a&&(d=a===!0),d},completed:function(){return e}}},r=function(a,b,c){return window.setTimeout(function(){if(m[a]){var d="timeout ("+b+"ms) exceeded on method '"+c+"'";(0,m[a].error)("timeout_error",d),delete m[a],delete g[a]}},b)},s=function(b,d,e){if("function"==typeof c.gotMessageObserver)try{c.gotMessageObserver(b,e)}catch(a){h("gotMessageObserver() raised an exception: "+a.toString())}if(e.id&&d){if(l[d]){var i=q(e.id,b,e.callbacks?e.callbacks:[]);n[e.id]={};try{if(e.callbacks&&f(e.callbacks)&&e.callbacks.length>0)for(var j=0;j<e.callbacks.length;j++){for(var k=e.callbacks[j],o=e.params,p=k.split("/"),r=0;r<p.length-1;r++){var s=p[r];"object"!=typeof o[s]&&(o[s]={}),o=o[s]}o[p[p.length-1]]=function(){var a=k;return function(b){return i.invoke(a,b)}}()}var t=l[d](i,e.params);i.delayReturn()||i.completed()||i.complete(t)}catch(a){var u="runtime_error",v=null;if("string"==typeof a?v=a:"object"==typeof a&&(a&&f(a)&&2==a.length?(u=a[0],v=a[1]):"string"==typeof a.error&&(u=a.error,a.message?"string"==typeof a.message?v=a.message:a=a.message:v="")),null===v)try{v=JSON.stringify(a),"undefined"==typeof v&&(v=a.toString())}catch(b){v=a.toString()}i.error(u,v)}}}else e.id&&e.callback?m[e.id]&&m[e.id].callbacks&&m[e.id].callbacks[e.callback]?m[e.id].callbacks[e.callback](e.params):h("ignoring invalid callback, id:"+e.id+" ("+e.callback+")"):e.id?m[e.id]?(e.error?(0,m[e.id].error)(e.error,e.message):e.result!==a?(0,m[e.id].success)(e.result):(0,m[e.id].success)(),delete m[e.id],delete g[e.id]):h("ignoring invalid response: "+e.id):d&&l[d]&&l[d]({origin:b},e.params)};d(c.window,c.origin,"string"==typeof c.scope?c.scope:"",s);var t=function(a){return"string"==typeof c.scope&&c.scope.length&&(a=[c.scope,a].join("::")),a},u=function(a,b){if(!a)throw"postMessage called with null message";var d=o?"post  ":"queue ";if(h(d+" message: "+JSON.stringify(a)),b||o){if("function"==typeof c.postMessageObserver)try{c.postMessageObserver(c.origin,a)}catch(a){h("postMessageObserver() raised an exception: "+a.toString())}c.window.postMessage(JSON.stringify(a),c.origin)}else p.push(a)},v=function(a,b){if(h("ready msg received"),o)throw"received ready message while in ready state.  help!";for(k+="ping"===b?"-R":"-L",w.unbind("__ready"),o=!0,h("ready msg accepted."),"ping"===b&&w.notify({method:"__ready",params:"pong"});p.length;)u(p.pop());"function"==typeof c.onReady&&c.onReady(w)},w={unbind:function(a){if(l[a]){if(!delete l[a])throw"can't delete method: "+a;return!0}return!1},bind:function(a,b){if(!a||"string"!=typeof a)throw"'method' argument to bind must be string";if(!b||"function"!=typeof b)throw"callback missing from bind params";if(l[a])throw"method '"+a+"' is already bound!";return l[a]=b,this},call:function(a){if(!a)throw"missing arguments to call function";if(!a.method||"string"!=typeof a.method)throw"'method' argument to call must be string";if(!a.success||"function"!=typeof a.success)throw"'success' callback missing from call";var c={},d=[],e=function(a,b){if("object"==typeof b)for(var f in b)if(b.hasOwnProperty(f)){var g=a+(a.length?"/":"")+f;"function"==typeof b[f]?(c[g]=b[f],d.push(g),delete b[f]):"object"==typeof b[f]&&e(g,b[f])}};e("",a.params);var f={id:b,method:t(a.method),params:a.params};d.length&&(f.callbacks=d),a.timeout&&r(b,a.timeout,t(a.method)),m[b]={callbacks:c,error:a.error,success:a.success},g[b]=s,b++,u(f)},notify:function(a){if(!a)throw"missing arguments to notify function";if(!a.method||"string"!=typeof a.method)throw"'method' argument to notify must be string";u({method:t(a.method),params:a.params})},destroy:function(){e(c.window,c.origin,"string"==typeof c.scope?c.scope:""),window.removeEventListener?window.removeEventListener("message",s,!1):window.detachEvent&&window.detachEvent("onmessage",s),o=!1,l={},n={},m={},c.origin=null,p=[],h("channel destroyed"),k=""}};return w.bind("__ready",v),setTimeout(function(){},0),w}}}();WinChan=function(){function d(a,b,c){a.attachEvent?a.attachEvent("on"+b,c):a.addEventListener&&a.addEventListener(b,c,!1)}function e(a,b,c){a.detachEvent?a.detachEvent("on"+b,c):a.removeEventListener&&a.removeEventListener(b,c,!1)}function f(){var a=-1,b=navigator.userAgent;if("Microsoft Internet Explorer"===navigator.appName){var c=new RegExp("MSIE ([0-9]{1,}[.0-9]{0,})");null!=c.exec(b)&&(a=parseFloat(RegExp.$1))}else if(b.indexOf("Trident")>-1){var c=new RegExp("rv:([0-9]{2,2}[.0-9]{0,})");null!==c.exec(b)&&(a=parseFloat(RegExp.$1))}return a>=8}function g(){try{var a=navigator.userAgent;return a.indexOf("Fennec/")!=-1||a.indexOf("Firefox/")!=-1&&a.indexOf("Android")!=-1}catch(a){}return!1}function h(){return window.JSON&&window.JSON.stringify&&window.JSON.parse&&window.postMessage}function i(a){/^https?:\/\//.test(a)||(a=window.location.href);var b=/^(https?:\/\/[\-_a-zA-Z\.0-9:]+)/.exec(a);return b?b[1]:a}function j(){for(var c=(window.location,window.opener.frames),d=c.length-1;d>=0;d--)try{if(c[d].location.protocol===window.location.protocol&&c[d].location.host===window.location.host&&c[d].name===b)return c[d]}catch(a){}}var b="__winchan_relay_frame",c="die",k=f();return h()?{open:function(f,h){function r(){if(l&&document.body.removeChild(l),l=a,p&&(p=clearInterval(p)),e(window,"message",s),e(window,"unload",r),o)try{o.close()}catch(a){n.postMessage(c,m)}o=n=a}function s(a){if(a.origin===m)try{var b=JSON.parse(a.data);"ready"===b.a?n.postMessage(q,m):"error"===b.a?(r(),h&&(h(b.d),h=null)):"response"===b.a&&(r(),h&&(h(null,b.d),h=null))}catch(a){}}if(!h)throw"missing required callback argument";var j;f.url||(j="missing required 'url' parameter"),f.relay_url||(j="missing required 'relay_url' parameter"),j&&setTimeout(function(){h(j)},0),f.window_name||(f.window_name=null),f.window_features&&!g()||(f.window_features=a);var l,m=i(f.url);if(m!==i(f.relay_url))return setTimeout(function(){h("invalid arguments: origin of url and relay_url must match")},0);var n;k&&(l=document.createElement("iframe"),l.setAttribute("src",f.relay_url),l.style.display="none",l.setAttribute("name",b),document.body.appendChild(l),n=l.contentWindow);var o=window.open(f.url,f.window_name,f.window_features);n||(n=o);var p=setInterval(function(){o&&o.closed&&(r(),h&&(h("unknown closed window"),h=null))},500),q=JSON.stringify({a:"request",d:f.params});return d(window,"unload",r),d(window,"message",s),{close:r,focus:function(){if(o)try{o.focus()}catch(a){}}}},onOpen:function(b){function h(a){a=JSON.stringify(a),k?g.doPost(a,f):g.postMessage(a,f)}function i(c){var d;try{d=JSON.parse(c.data)}catch(a){}d&&"request"===d.a&&(e(window,"message",i),f=c.origin,b&&setTimeout(function(){b(f,d.d,function(c){b=a,h({a:"response",d:c})})},0))}function l(a){if(a.data===c)try{window.close()}catch(a){}}var f="*",g=k?j():window.opener;if(!g)throw"can't find relay frame";d(k?g:window,"message",i),d(k?g:window,"message",l);try{h({a:"ready"})}catch(a){d(g,"load",function(a){h({a:"ready"})})}var m=function(){try{e(k?g:window,"message",l)}catch(a){}b&&h({a:"error",d:"client closed window"}),b=a;try{window.close()}catch(a){}};return d(window,"unload",m),{detach:function(){e(window,"unload",m)}}}}:{open:function(a,b,c,d){setTimeout(function(){d("unsupported browser")},0)},onOpen:function(a){setTimeout(function(){a("unsupported browser")},0)}}}();var c=function(){function d(c,d){b=c,a=d}function e(){var a=-1;if("Microsoft Internet Explorer"==b.appName){var c=b.userAgent,d=new RegExp("MSIE ([0-9]{1,}[.0-9]{0,})");null!=d.exec(c)&&(a=parseFloat(RegExp.$1))}return a}function f(){var a=e(),b=a>-1&&a<8;if(b)return"BAD_IE_VERSION"}function g(){return f()}function h(){try{var b="localStorage"in a&&null!==a.localStorage;if(!b)return"LOCALSTORAGE_NOT_SUPPORTED";a.localStorage.setItem("test","true"),a.localStorage.removeItem("test")}catch(a){return"LOCALSTORAGE_DISABLED"}}function i(){if(!a.postMessage)return"POSTMESSAGE_NOT_SUPPORTED"}function j(){if(!(window.JSON&&window.JSON.stringify&&window.JSON.parse))return"JSON_NOT_SUPPORTED"}function k(){return c=g()||h()||i()||j(),!c}function l(){return c}var c,a=window,b=navigator;return{setTestEnv:d,isSupported:k,getNoSupportReason:l}}();if(navigator.id||(navigator.id={}),!navigator.id.request||navigator.id._shimmed){var k,m,p,C,d="https://login.persona.org",e=navigator.userAgent,f=e.indexOf("Fennec/")!=-1||e.indexOf("Firefox/")!=-1&&e.indexOf("Android")!=-1,g=f?a:"menubar=0,location=1,resizable=1,scrollbars=1,status=0,width=700,height=375",h=e.match(/CriOS/)||e.match(/Windows Phone/),i="WATCH_NEEDED",j="__persona_dialog",l={login:null,logout:null,match:null,ready:null},n=a,q=!1,r=c.isSupported();navigator.id={request:function(a){if(this!=navigator.id)throw new Error("all navigator.id calls must be made on the navigator.id object");if(!l.login)throw new Error("navigator.id.watch must be called before navigator.id.request");return a=a||{},o(!1),C="request",a.returnTo||(a.returnTo=document.location.pathname),E(a)},watch:function(a){if(this!=navigator.id)throw new Error("all navigator.id calls must be made on the navigator.id object");o(!1),y(a)},logout:function(a){if(this!=navigator.id)throw new Error("all navigator.id calls must be made on the navigator.id object");t(),p&&p.notify({method:"logout"}),"function"==typeof a&&(v("navigator.id.logout callback argument has been deprecated."),setTimeout(a,0))},get:function(b,c){var d={};return c=c||{},d.privacyPolicy=c.privacyPolicy||a,d.termsOfService=c.termsOfService||a,d.privacyURL=c.privacyURL||a,d.tosURL=c.tosURL||a,d.siteName=c.siteName||a,d.siteLogo=c.siteLogo||a,d.backgroundColor=c.backgroundColor||a,d.experimental_emailHint=c.experimental_emailHint||a,C=C||"get",w(c,"silent")?void(b&&setTimeout(function(){b(null)},0)):(o(!0),y({onlogin:function(a){b&&(b(a),b=null)},onlogout:function(){}}),d.oncancel=function(){b&&(b(null),b=null),l.login=l.logout=l.match=l.ready=null},void E(d))},getVerifiedEmail:function(a){v("navigator.id.getVerifiedEmail has been deprecated"),o(!0),C="getVerifiedEmail",navigator.id.get(a)},_shimmed:!0}}}()}();